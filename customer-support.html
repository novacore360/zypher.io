<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoBridge Live Support</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Complete Realistic Support System */
        :root {
            --primary: #2563eb;
            --primary-light: #3b82f6;
            --primary-dark: #1d4ed8;
            --success: #10b981;
            --success-light: #34d399;
            --warning: #f59e0b;
            --warning-light: #fbbf24;
            --error: #ef4444;
            --background: #ffffff;
            --surface: #f8fafc;
            --border: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
        }

        .support-system {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        /* Floating Chat Widget */
        .floating-support {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 10000;
        }

        .support-toggle {
            width: 65px;
            height: 65px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 26px;
            cursor: pointer;
            box-shadow: 0 10px 40px rgba(37, 99, 235, 0.4);
            border: 3px solid white;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .support-toggle:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 15px 50px rgba(37, 99, 235, 0.6);
        }

        .support-toggle.active {
            transform: rotate(45deg);
            background: linear-gradient(135deg, var(--warning), var(--warning-light));
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--error);
            color: white;
            font-size: 12px;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Support Container */
        .support-container {
            position: absolute;
            bottom: 85px;
            right: 0;
            width: 420px;
            height: 680px;
            background: var(--background);
            border-radius: 24px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.25);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--border);
            transform-origin: bottom right;
        }

        .support-container.active {
            display: flex;
            animation: slideUpScale 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideUpScale {
            from {
                opacity: 0;
                transform: translateY(20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Header */
        .support-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            position: relative;
        }

        .agent-avatar {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
        }

        .agent-info h3 {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            line-height: 1.3;
        }

        .agent-info p {
            font-size: 13px;
            opacity: 0.9;
            margin: 6px 0 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--success-light);
            border-radius: 50%;
            position: relative;
        }

        .status-dot::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--success-light);
            border-radius: 50%;
            animation: ping 1.5s infinite;
        }

        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .header-actions {
            margin-left: auto;
            display: flex;
            gap: 12px;
        }

        .header-action {
            background: rgba(255,255,255,0.15);
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 16px;
        }

        .header-action:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-1px);
        }

        /* Messages Area */
        .support-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            background: var(--surface);
            display: flex;
            flex-direction: column;
            gap: 20px;
            position: relative;
        }

        .welcome-section {
            background: linear-gradient(135deg, rgba(37,99,235,0.1), rgba(37,99,235,0.05));
            border: 1px solid rgba(37,99,235,0.2);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 10px;
            animation: slideInLeft 0.5s ease;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .message {
            max-width: 85%;
            padding: 16px 20px;
            border-radius: 22px;
            font-size: 14.5px;
            line-height: 1.5;
            position: relative;
            animation: messageAppear 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        @keyframes messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .message.bot {
            background: white;
            border: 1px solid var(--border);
            border-bottom-left-radius: 8px;
            align-self: flex-start;
            margin-right: auto;
        }

        .message.user {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border-bottom-right-radius: 8px;
            align-self: flex-end;
            margin-left: auto;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 8px;
            display: block;
            font-weight: 500;
        }

        .message-typing {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 16px 20px;
            background: white;
            border-radius: 22px;
            border: 1px solid var(--border);
            width: fit-content;
            border-bottom-left-radius: 8px;
            margin-bottom: 5px;
        }

        .typing-text {
            font-size: 13px;
            color: var(--text-secondary);
            font-style: italic;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            background: var(--text-secondary);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typingBounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-6px); }
        }

        /* Information Cards */
        .info-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 18px;
            margin: 8px 0;
            border-left: 4px solid var(--primary);
        }

        .info-card.success {
            border-left-color: var(--success);
            background: linear-gradient(135deg, rgba(16,185,129,0.05), rgba(16,185,129,0.02));
        }

        .info-card.warning {
            border-left-color: var(--warning);
            background: linear-gradient(135deg, rgba(245,158,11,0.05), rgba(245,158,11,0.02));
        }

        .info-card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .info-card-icon {
            width: 32px;
            height: 32px;
            background: var(--primary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
        }

        .info-card.success .info-card-icon {
            background: var(--success);
        }

        .info-card.warning .info-card-icon {
            background: var(--warning);
        }

        .info-card-title {
            font-weight: 700;
            font-size: 15px;
            color: var(--text-primary);
        }

        .info-card-content {
            font-size: 13.5px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Input Area */
        .support-input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid var(--border);
            position: relative;
        }

        .input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .support-input {
            flex: 1;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: 16px;
            font-size: 14.5px;
            line-height: 1.5;
            outline: none;
            transition: all 0.3s;
            background: var(--surface);
            resize: none;
            min-height: 52px;
            max-height: 120px;
            font-family: inherit;
        }

        .support-input:focus {
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
        }

        .send-button {
            width: 52px;
            height: 52px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 16px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 18px;
            flex-shrink: 0;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(37,99,235,0.3);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 0 20px 20px;
            background: white;
        }

        .quick-action {
            padding: 10px 18px;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            font-size: 13.5px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-action:hover {
            background: white;
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(37,99,235,0.1);
        }

        .quick-action i {
            font-size: 12px;
        }

        /* Ticket System */
        .ticket-system {
            padding: 20px;
            background: white;
            display: none;
            flex-direction: column;
            gap: 16px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .ticket-system.active {
            display: flex;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-size: 13.5px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-label i {
            color: var(--primary);
            font-size: 12px;
        }

        .form-input {
            padding: 14px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
            background: var(--surface);
        }

        .form-input:focus {
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
        }

        .form-actions {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }

        .form-button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 14.5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .form-button.primary {
            background: linear-gradient(135deg, var(--success), var(--success-light));
            color: white;
        }

        .form-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16,185,129,0.3);
        }

        .form-button.secondary {
            background: var(--surface);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .form-button.secondary:hover {
            background: white;
            border-color: var(--border);
            color: var(--text-primary);
        }

        /* Success States */
        .success-state {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 40px 24px;
            text-align: center;
        }

        .success-state.active {
            display: flex;
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--success), var(--success-light));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(16,185,129,0.3);
        }

        .success-content h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .success-content p {
            font-size: 14.5px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .ticket-id {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px 20px;
            font-family: 'SF Mono', monospace;
            font-size: 13px;
            color: var(--text-primary);
            margin: 10px 0;
            font-weight: 600;
        }

        /* Typing Indicator with Agent Info */
        .typing-with-agent {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .typing-agent-avatar {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--primary-light), var(--primary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            flex-shrink: 0;
        }

        /* Emotional Tone Indicators */
        .empathy-indicator {
            display: inline-block;
            margin-right: 6px;
            font-size: 16px;
        }

        /* Mobile Responsive */
        @media (max-width: 500px) {
            .floating-support {
                bottom: 20px;
                right: 20px;
            }

            .support-container {
                width: calc(100vw - 40px);
                height: 80vh;
                right: 10px;
            }

            .support-toggle {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
        }

        /* Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --background: #1e293b;
                --surface: #0f172a;
                --border: #334155;
                --text-primary: #f1f5f9;
                --text-secondary: #cbd5e1;
            }

            .support-container {
                background: var(--background);
                border-color: var(--border);
            }

            .support-messages {
                background: var(--surface);
            }

            .message.bot {
                background: #334155;
                border-color: #475569;
            }

            .message-typing {
                background: #334155;
                border-color: #475569;
            }

            .info-card {
                background: #334155;
                border-color: #475569;
            }

            .support-input-area,
            .quick-actions,
            .ticket-system {
                background: var(--background);
                border-color: var(--border);
            }

            .support-input,
            .form-input {
                background: var(--surface);
                border-color: var(--border);
                color: var(--text-primary);
            }

            .quick-action {
                background: #334155;
                border-color: #475569;
                color: var(--text-primary);
            }

            .quick-action:hover {
                background: #475569;
                border-color: var(--primary);
            }

            .ticket-id {
                background: #334155;
                border-color: #475569;
                color: var(--text-primary);
            }
        }
    </style>
</head>
<body>
    <div class="support-system">
        <!-- Floating Support Button -->
        <div class="floating-support">
            <div class="support-toggle" id="supportToggle">
                <i class="fas fa-headset"></i>
                <div class="notification-badge" id="notificationBadge" style="display: none;">1</div>
            </div>

            <!-- Support Container -->
            <div class="support-container" id="supportContainer">
                <!-- Header -->
                <div class="support-header">
                    <div class="agent-avatar" id="agentAvatar">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="agent-info">
                        <h3 id="agentName">Sarah Johnson</h3>
                        <p>
                            <span class="status-indicator">
                                <span class="status-dot"></span>
                                <span>Live Support â€¢ Online Now</span>
                            </span>
                        </p>
                    </div>
                    <div class="header-actions">
                        <button class="header-action" id="minimizeChat" title="Minimize">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="header-action" id="closeChat" title="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- Messages Area -->
                <div class="support-messages" id="supportMessages">
                    <!-- Messages load here -->
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions" id="quickActions">
                    <button class="quick-action" data-action="transaction-help">
                        <i class="fas fa-exchange-alt"></i> Transaction Help
                    </button>
                    <button class="quick-action" data-action="payment-time">
                        <i class="fas fa-clock"></i> Processing Time
                    </button>
                    <button class="quick-action" data-action="security-check">
                        <i class="fas fa-shield-alt"></i> Security Check
                    </button>
                    <button class="quick-action" data-action="submit-ticket">
                        <i class="fas fa-ticket-alt"></i> Submit Ticket
                    </button>
                </div>

                <!-- Input Area -->
                <div class="support-input-area" id="supportInputArea">
                    <div class="input-container">
                        <textarea class="support-input" id="supportInput" 
                                  placeholder="Type your message here... We're here to help 24/7 ðŸš€" 
                                  rows="1"></textarea>
                        <button class="send-button" id="sendButton">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Ticket System -->
                <div class="ticket-system" id="ticketSystem">
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-envelope"></i> Your PayPal Email
                        </label>
                        <input type="email" class="form-input" id="ticketEmail" 
                               placeholder="your.email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-wallet"></i> Wallet Address Used
                        </label>
                        <input type="text" class="form-input" id="ticketWallet" 
                               placeholder="0x... or bc1..." required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">
                            <i class="fas fa-comment-dots"></i> What happened?
                        </label>
                        <textarea class="form-input" id="ticketMessage" 
                                  placeholder="Please describe the issue in detail. The more information you provide, the better we can help! ðŸ˜Š"
                                  rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button class="form-button secondary" id="cancelTicket">
                            <i class="fas fa-arrow-left"></i> Back to Chat
                        </button>
                        <button class="form-button primary" id="submitTicket">
                            <i class="fas fa-paper-plane"></i> Submit Ticket
                        </button>
                    </div>
                </div>

                <!-- Success State -->
                <div class="success-state" id="successState">
                    <div class="success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="success-content">
                        <h3>Ticket Submitted Successfully! ðŸŽ‰</h3>
                        <p>Your support ticket has been received and is being processed by our team.</p>
                        <div class="ticket-id" id="ticketIdDisplay">TICKET-XXXXXXXX</div>
                        <p><strong>What happens next:</strong><br>
                        1. Immediate review by our specialists<br>
                        2. Blockchain verification check<br>
                        3. Personal email update within 15 minutes<br>
                        4. Resolution typically within 1-2 hours</p>
                        <button class="form-button secondary" id="backToChat">
                            <i class="fas fa-comments"></i> Back to Chat
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Advanced Real Customer Support System
        document.addEventListener('DOMContentLoaded', function() {
            // Core Configuration
            const CONFIG = {
                AI_API_KEY: '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',
                COMPANY_INFO: {
                    name: 'CryptoBridge',
                    supportEmail: 'support@cryptobridge.com',
                    phone: '+1 (888) 555-0123',
                    hours: '24/7',
                    license: 'CR-2023-456789',
                    address: '123 Financial District, San Francisco, CA 94111'
                },
                PROCESSING_TIMES: {
                    normal: '5-15 minutes',
                    extended: '15-30 minutes (rare)',
                    verification: '5 minutes',
                    blockchain: '5-30 minutes'
                }
            };

            // DOM Elements
            const elements = {
                supportToggle: document.getElementById('supportToggle'),
                supportContainer: document.getElementById('supportContainer'),
                agentName: document.getElementById('agentName'),
                agentAvatar: document.getElementById('agentAvatar'),
                supportMessages: document.getElementById('supportMessages'),
                supportInput: document.getElementById('supportInput'),
                sendButton: document.getElementById('sendButton'),
                quickActions: document.getElementById('quickActions'),
                ticketSystem: document.getElementById('ticketSystem'),
                successState: document.getElementById('successState'),
                notificationBadge: document.getElementById('notificationBadge'),
                minimizeChat: document.getElementById('minimizeChat'),
                closeChat: document.getElementById('closeChat')
            };

            // State Management
            const state = {
                isOpen: false,
                isTyping: false,
                conversationHistory: [],
                currentAgent: null,
                userSentiment: 'neutral',
                ticketData: {},
                unreadMessages: 0,
                typingTimeout: null,
                lastInteraction: Date.now()
            };

            // Enhanced Support Agents with Personalities
            const SUPPORT_AGENTS = [
                {
                    id: 'sarah',
                    name: 'Sarah Johnson',
                    title: 'Senior Support Specialist',
                    avatar: 'ðŸ‘©â€ðŸ’¼',
                    color: '#2563eb',
                    personality: 'empathetic',
                    specialty: 'transaction_help',
                    experience: '8 years in crypto support',
                    responseStyle: 'warm, detailed, reassuring',
                    workingHours: '9AM-6PM PST',
                    languages: ['English', 'Spanish']
                },
                {
                    id: 'michael',
                    name: 'Michael Chen',
                    title: 'Transaction Expert',
                    avatar: 'ðŸ‘¨â€ðŸ’»',
                    color: '#10b981',
                    personality: 'analytical',
                    specialty: 'technical_issues',
                    experience: '6 years blockchain expert',
                    responseStyle: 'precise, technical, solution-oriented',
                    workingHours: '24/7 rotating',
                    languages: ['English', 'Mandarin']
                },
                {
                    id: 'emma',
                    name: 'Emma Rodriguez',
                    title: 'Customer Success Manager',
                    avatar: 'ðŸ‘©â€ðŸ’¼',
                    color: '#8b5cf6',
                    personality: 'nurturing',
                    specialty: 'account_issues',
                    experience: '7 years fintech support',
                    responseStyle: 'caring, patient, thorough',
                    workingHours: '10AM-7PM PST',
                    languages: ['English', 'Spanish', 'Portuguese']
                },
                {
                    id: 'david',
                    name: 'David Wilson',
                    title: 'Payment Processing Lead',
                    avatar: 'ðŸ‘¨â€ðŸ’¼',
                    color: '#f59e0b',
                    personality: 'efficient',
                    specialty: 'payment_issues',
                    experience: '9 years payment systems',
                    responseStyle: 'direct, efficient, reassuring',
                    workingHours: '24/7 on-call',
                    languages: ['English', 'French']
                }
            ];

            // Emotional Responses Database
            const EMOTIONAL_RESPONSES = {
                worried: [
                    "I completely understand why you'd be concerned. Let me reassure you...",
                    "It's completely normal to feel worried about transactions. I'm here to help put your mind at ease...",
                    "I can hear the concern in your message. Don't worry - we'll sort this out together...",
                    "Thank you for sharing your concern with me. Let me provide some clarity on this..."
                ],
                frustrated: [
                    "I apologize for the frustration you're experiencing. That sounds really frustrating...",
                    "I'd be frustrated too in that situation. Let me help resolve this for you...",
                    "I'm sorry you're going through this. Let me take care of it for you...",
                    "That sounds incredibly frustrating. I'm going to personally ensure this gets resolved..."
                ],
                confused: [
                    "That's a great question and I'd be happy to clarify this for you...",
                    "I can see how that might be confusing. Let me break it down simply...",
                    "That's actually a common point of confusion. Here's what you need to know...",
                    "I appreciate you asking for clarification. Let me explain this clearly..."
                ],
                happy: [
                    "That's wonderful to hear! I'm so glad everything is working smoothly for you...",
                    "Fantastic! I love hearing success stories from our customers...",
                    "That's music to my ears! Thank you for sharing the good news...",
                    "I'm thrilled to hear that! Is there anything else I can help you with today?"
                ]
            };

            // Conversation Memory
            const conversationMemory = {
                userContext: {},
                previousIssues: [],
                preferences: {},
                sentimentHistory: []
            };

            // Initialize Support System
            function initSupportSystem() {
                loadConversationHistory();
                assignRandomAgent();
                showWelcomeMessage();
                setupEventListeners();
                setupAutoResponses();
                checkForPendingTickets();
            }

            // Setup Event Listeners
            function setupEventListeners() {
                elements.supportToggle.addEventListener('click', toggleSupport);
                elements.minimizeChat.addEventListener('click', minimizeSupport);
                elements.closeChat.addEventListener('click', closeSupport);
                elements.sendButton.addEventListener('click', sendMessage);
                elements.supportInput.addEventListener('keypress', handleKeyPress);
                elements.supportInput.addEventListener('input', handleInput);
                
                // Quick actions
                elements.quickActions.addEventListener('click', handleQuickAction);
                
                // Ticket system
                document.getElementById('cancelTicket').addEventListener('click', hideTicketSystem);
                document.getElementById('submitTicket').addEventListener('click', submitTicket);
                document.getElementById('backToChat').addEventListener('click', backToChat);
                
                // Auto-close when clicking outside (for mobile)
                document.addEventListener('click', handleOutsideClick);
                
                // Check for inactivity
                setInterval(checkInactivity, 60000);
            }

            // Toggle Support Window
            function toggleSupport() {
                state.isOpen = !state.isOpen;
                elements.supportToggle.classList.toggle('active');
                elements.supportContainer.classList.toggle('active');
                
                if (state.isOpen) {
                    elements.supportInput.focus();
                    state.unreadMessages = 0;
                    updateNotificationBadge();
                    updateLastInteraction();
                    
                    // Rotate agent for fresh conversation
                    if (state.conversationHistory.length > 10) {
                        assignRandomAgent();
                    }
                }
            }

            // Minimize Support
            function minimizeSupport() {
                state.isOpen = false;
                elements.supportContainer.classList.remove('active');
                elements.supportToggle.classList.remove('active');
            }

            // Close Support
            function closeSupport() {
                state.isOpen = false;
                elements.supportContainer.classList.remove('active');
                elements.supportToggle.classList.remove('active');
                
                // Save conversation
                saveConversationHistory();
            }

            // Handle Key Press
            function handleKeyPress(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            }

            // Handle Input
            function handleInput() {
                // Auto-resize textarea
                elements.supportInput.style.height = 'auto';
                elements.supportInput.style.height = Math.min(elements.supportInput.scrollHeight, 120) + 'px';
                
                // Update last interaction
                updateLastInteraction();
            }

            // Send Message
            async function sendMessage() {
                const message = elements.supportInput.value.trim();
                if (!message || state.isTyping) return;
                
                // Add user message
                addMessage('user', message);
                elements.supportInput.value = '';
                elements.supportInput.style.height = 'auto';
                elements.sendButton.disabled = true;
                
                // Analyze sentiment
                analyzeSentiment(message);
                
                // Show typing indicator
                showTypingIndicator();
                
                // Generate AI response with realistic delays
                const typingDelay = calculateTypingDelay(message.length);
                const thinkingTime = 500 + Math.random() * 1500;
                
                setTimeout(async () => {
                    const response = await generateIntelligentResponse(message);
                    
                    hideTypingIndicator();
                    
                    // Simulate typing out response
                    typeResponse(response);
                    
                    elements.sendButton.disabled = false;
                    elements.supportInput.focus();
                }, typingDelay + thinkingTime);
            }

            // Add Message to Chat
            function addMessage(sender, content, type = 'text') {
                const messageDiv = document.createElement('div');
                const timestamp = new Date();
                const timeString = timestamp.toLocaleTimeString([], { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                if (sender === 'bot') {
                    messageDiv.className = 'message bot';
                    messageDiv.innerHTML = `
                        ${content}
                        <span class="message-time">${timeString} â€¢ ${state.currentAgent.name}</span>
                    `;
                } else {
                    messageDiv.className = 'message user';
                    messageDiv.innerHTML = `
                        ${content}
                        <span class="message-time">${timeString}</span>
                    `;
                }
                
                elements.supportMessages.appendChild(messageDiv);
                elements.supportMessages.scrollTop = elements.supportMessages.scrollHeight;
                
                // Add to conversation history
                state.conversationHistory.push({
                    sender,
                    content,
                    type,
                    timestamp: timestamp.toISOString(),
                    agent: sender === 'bot' ? state.currentAgent.name : null,
                    sentiment: state.userSentiment
                });
                
                // Update conversation memory
                updateConversationMemory(sender, content);
                
                // Save conversation
                saveConversationHistory();
            }

            // Show Typing Indicator
            function showTypingIndicator() {
                if (state.isTyping) return;
                state.isTyping = true;
                
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-with-agent';
                typingDiv.innerHTML = `
                    <div class="typing-agent-avatar" style="background: ${state.currentAgent.color}">
                        ${state.currentAgent.avatar}
                    </div>
                    <div class="message-typing">
                        <span class="typing-text">${state.currentAgent.name} is typing</span>
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
                
                elements.supportMessages.appendChild(typingDiv);
                elements.supportMessages.scrollTop = elements.supportMessages.scrollHeight;
            }

            // Hide Typing Indicator
            function hideTypingIndicator() {
                state.isTyping = false;
                const typingIndicator = elements.supportMessages.querySelector('.typing-with-agent');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            // Type Response with Realistic Typing
            function typeResponse(response) {
                const words = response.split(' ');
                let currentWord = 0;
                let typedText = '';
                
                function typeNextWord() {
                    if (currentWord < words.length) {
                        typedText += (currentWord > 0 ? ' ' : '') + words[currentWord];
                        addMessage('bot', typedText);
                        currentWord++;
                        
                        // Vary typing speed for realism
                        const wordLength = words[currentWord - 1]?.length || 0;
                        const delay = Math.max(30, Math.min(120, wordLength * 10)) + Math.random() * 50;
                        
                        state.typingTimeout = setTimeout(typeNextWord, delay);
                    } else {
                        // Add slight pause after completion
                        setTimeout(() => {
                            suggestFollowUp(response);
                        }, 500);
                    }
                }
                
                // Clear any existing typing
                hideTypingIndicator();
                
                // Start typing
                typeNextWord();
            }

            // Calculate Realistic Typing Delay
            function calculateTypingDelay(messageLength) {
                const baseDelay = 800;
                const lengthDelay = messageLength * 15;
                const randomDelay = Math.random() * 1000;
                return baseDelay + lengthDelay + randomDelay;
            }

            // Generate Intelligent AI Response
            async function generateIntelligentResponse(userMessage) {
                try {
                    // For production, use actual AI API
                    // const aiResponse = await getAIResponseFromAPI(userMessage);
                    // return aiResponse;
                    
                    // For demo, use our intelligent response system
                    return generateContextualResponse(userMessage);
                } catch (error) {
                    console.error('AI Response Error:', error);
                    return generateFallbackResponse(userMessage);
                }
            }

            // Generate Contextual Response
            function generateContextualResponse(userMessage) {
                const lowerMessage = userMessage.toLowerCase();
                const sentiment = state.userSentiment;
                const agent = state.currentAgent;
                
                // Get emotional opening
                const emotionalOpening = getEmotionalOpening(sentiment);
                
                // Check message intent
                if (lowerMessage.includes('thank') || lowerMessage.includes('thanks')) {
                    return `${emotionalOpening}You're very welcome! ${getRandom([
                        "I'm glad I could help.",
                        "Happy to be of assistance!",
                        "It's my pleasure to help.",
                        "That's what I'm here for! ðŸ˜Š"
                    ])} ${getAgentSignoff(agent)}`;
                }
                
                if (lowerMessage.includes('status') || lowerMessage.includes('where') || lowerMessage.includes('track')) {
                    return `${emotionalOpening}${generateTransactionStatusResponse()}`;
                }
                
                if (lowerMessage.includes('time') || lowerMessage.includes('how long') || lowerMessage.includes('wait')) {
                    return `${emotionalOpening}${generateProcessingTimeResponse()}`;
                }
                
                if (lowerMessage.includes('bonus') || lowerMessage.includes('+10%') || lowerMessage.includes('extra')) {
                    return `${emotionalOpening}${generateBonusExplanation()}`;
                }
                
                if (lowerMessage.includes('security') || lowerMessage.includes('safe') || lowerMessage.includes('trust')) {
                    return `${emotionalOpening}${generateSecurityReassurance()}`;
                }
                
                if (lowerMessage.includes('problem') || lowerMessage.includes('issue') || lowerMessage.includes('not work')) {
                    return `${emotionalOpening}${generateProblemResolution()}`;
                }
                
                // Default intelligent response
                return `${emotionalOpening}${generateGeneralResponse(userMessage)}`;
            }

            // Generate Transaction Status Response
            function generateTransactionStatusResponse() {
                return `
                    I understand you're checking on your transaction status. ${getRandom([
                        "Let me explain how our tracking works...",
                        "I'd be happy to help you track that down.",
                        "I can see why you'd want an update on that."
                    ])}
                    
                    <div class="info-card success">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-search"></i>
                            </div>
                            <div class="info-card-title">How to Check Your Transaction</div>
                        </div>
                        <div class="info-card-content">
                            <strong>Option 1:</strong> Check your email for the transaction confirmation<br>
                            <strong>Option 2:</strong> Look for the transaction ID in your account<br>
                            <strong>Option 3:</strong> Submit a ticket with your details for a manual check
                        </div>
                    </div>
                    
                    Most transactions complete within <strong>${CONFIG.PROCESSING_TIMES.normal}</strong>. If it's been longer, I recommend submitting a ticket so I can personally look into it for you.
                    
                    ${getRandom([
                        "Would you like me to help you submit a ticket?",
                        "Can you provide your transaction details so I can check?",
                        "Shall we get this sorted out together?"
                    ])}
                `;
            }

            // Generate Processing Time Response
            function generateProcessingTimeResponse() {
                return `
                    I completely understand wanting to know about processing times! ${getRandom([
                        "It's one of our most common questions.",
                        "Everyone wants to know when their funds will arrive.",
                        "Timing is everything when it comes to transactions."
                    ])}
                    
                    <div class="info-card">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="info-card-title">Realistic Processing Timeline</div>
                        </div>
                        <div class="info-card-content">
                            <strong>ðŸ•’ 0-5 minutes:</strong> Blockchain confirmation (network dependent)<br>
                            <strong>âœ… 1-2 minutes:</strong> Internal verification & amount check<br>
                            <strong>ðŸš€ 2-3 minutes:</strong> PayPal payment initiation<br>
                            <strong>ðŸ’° 2-5 minutes:</strong> PayPal processing & delivery<br>
                            <strong>ðŸ“§ Instant:</strong> Email confirmation sent
                        </div>
                    </div>
                    
                    <div class="info-card warning">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="info-card-title">Why Times May Vary</div>
                        </div>
                        <div class="info-card-content">
                            â€¢ Blockchain network congestion<br>
                            â€¢ PayPal verification requirements<br>
                            â€¢ Amount being exchanged (larger amounts have extra checks)<br>
                            â€¢ Time of day (we're actually 24/7, but banks have hours)<br>
                            â€¢ Security verification steps (for your protection)
                        </div>
                    </div>
                    
                    ${getRandom([
                        "Rest assured, we're monitoring your transaction every step of the way.",
                        "I'll personally keep an eye on it if you're concerned.",
                        "Our automated systems are working round the clock to process transactions."
                    ])}
                `;
            }

            // Generate Bonus Explanation
            function generateBonusExplanation() {
                return `
                    The +10% bonus is one of our favorite features to explain! ${getRandom([
                        "It's what sets us apart from other exchanges.",
                        "Our customers absolutely love this benefit.",
                        "It's our way of giving back to our community."
                    ])}
                    
                    <div class="info-card success">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-gift"></i>
                            </div>
                            <div class="info-card-title">How the +10% Bonus Works</div>
                        </div>
                        <div class="info-card-content">
                            <strong>1.</strong> We check real-time market prices from 5+ exchanges<br>
                            <strong>2.</strong> Take the best available rate<br>
                            <strong>3.</strong> Add 10% on top of that rate<br>
                            <strong>4.</strong> Apply it automatically to your transaction<br>
                            <strong>5.</strong> Show you the exact amount in your summary
                        </div>
                    </div>
                    
                    <strong>Real Example:</strong><br>
                    If you send $1,000 worth of Bitcoin, you receive $1,100 in PayPal funds. Yes, really! ðŸ’«
                    
                    ${getRandom([
                        "It's completely transparent - no hidden catches.",
                        "This bonus applies to every single transaction.",
                        "We believe in providing real value to our customers."
                    ])}
                `;
            }

            // Generate Security Reassurance
            function generateSecurityReassurance() {
                return `
                    Security is our absolute top priority. ${getRandom([
                        "I take your security as seriously as I take my own.",
                        "We've built this platform with security as the foundation.",
                        "Your trust means everything to us."
                    ])}
                    
                    <div class="info-card">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="info-card-title">Our Security Measures</div>
                        </div>
                        <div class="info-card-content">
                            <strong>ðŸ” Multi-Signature Wallets:</strong> 3-of-5 signature requirement<br>
                            <strong>â„ï¸ Cold Storage:</strong> 95% of funds offline<br>
                            <strong>ðŸ”’ SSL Encryption:</strong> Bank-grade 256-bit encryption<br>
                            <strong>ðŸ‘¥ KYC/AML:</strong> Full regulatory compliance<br>
                            <strong>ðŸ’° Insurance:</strong> $1,000,000 coverage per transaction<br>
                            <strong>ðŸ” Regular Audits:</strong> Monthly security reviews
                        </div>
                    </div>
                    
                    <div class="info-card success">
                        <div class="info-card-header">
                            <div class="info-card-icon">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="info-card-title">Your Role in Security</div>
                        </div>
                        <div class="info-card-content">
                            â€¢ Never share your private keys<br>
                            â€¢ Use unique passwords<br>
                            â€¢ Enable 2FA when available<br>
                            â€¢ Verify email confirmations<br>
                            â€¢ Only use official channels
                        </div>
                    </div>
                    
                    ${getRandom([
                        "We've processed millions in transactions with zero security incidents.",
                        "Your funds are as safe with us as they are in a bank.",
                        "Sleep well knowing your assets are protected."
                    ])}
                `;
            }

            // Get Emotional Opening
            function getEmotionalOpening(sentiment) {
                const openings = EMOTIONAL_RESPONSES[sentiment] || EMOTIONAL_RESPONSES.neutral;
                return getRandom(openings) + ' ';
            }

            // Get Random Array Element
            function getRandom(array) {
                return array[Math.floor(Math.random() * array.length)];
            }

            // Get Agent Signoff
            function getAgentSignoff(agent) {
                const signoffs = [
                    `I'm ${agent.name.split(' ')[0]}, by the way - here if you need anything else!`,
                    `This is ${agent.name.split(' ')[0]} - don't hesitate to reach out again.`,
                    `- ${agent.name.split(' ')[0]} ðŸ¤`,
                    `All the best, ${agent.name.split(' ')[0]}`
                ];
                return getRandom(signoffs);
            }

            // Initialize the system
            initSupportSystem();

            // Note: The complete system includes much more functionality including:
            // - Actual AI API integration
            // - Ticket management system
            // - Email notifications
            // - Database integration
            // - Admin dashboard
            // - Real-time updates
            // - Performance analytics
            // - Multi-language support
            // - Escalation protocols
            // - SLA monitoring
            // - Customer satisfaction tracking
            
            // This code provides a solid foundation that can be expanded for production use.

        });
    </script>
</body>
</html>
