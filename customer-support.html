<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoBridge Professional Support</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Enhanced Mobile-First Design */
        :root {
            --cryptobridge-primary: #2563eb;
            --cryptobridge-primary-light: #3b82f6;
            --cryptobridge-primary-dark: #1d4ed8;
            --cryptobridge-success: #10b981;
            --cryptobridge-success-light: #34d399;
            --cryptobridge-warning: #f59e0b;
            --cryptobridge-warning-light: #fbbf24;
            --cryptobridge-error: #ef4444;
            --cryptobridge-background: #ffffff;
            --cryptobridge-surface: #f8fafc;
            --cryptobridge-border: #e2e8f0;
            --cryptobridge-text-primary: #1e293b;
            --cryptobridge-text-secondary: #64748b;
            --cryptobridge-gradient: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            --cryptobridge-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --cryptobridge-shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .cryptobridge-support-system {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        /* Enhanced Floating Chat Widget for Mobile */
        .cryptobridge-floating-support {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 10000;
        }

        @media (max-width: 768px) {
            .cryptobridge-floating-support {
                bottom: 16px;
                right: 16px;
                left: 16px;
                display: flex;
                justify-content: flex-end;
            }
        }

        .cryptobridge-support-toggle {
            width: 68px;
            height: 68px;
            background: var(--cryptobridge-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: var(--cryptobridge-shadow-lg);
            border: 4px solid rgba(255, 255, 255, 0.9);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .cryptobridge-support-toggle:hover {
            transform: scale(1.15) rotate(5deg);
            box-shadow: 0 20px 60px rgba(37, 99, 235, 0.5);
        }

        .cryptobridge-support-toggle.active {
            transform: rotate(45deg);
            background: linear-gradient(135deg, var(--cryptobridge-warning), var(--cryptobridge-warning-light));
        }

        @media (max-width: 768px) {
            .cryptobridge-support-toggle {
                width: 62px;
                height: 62px;
                font-size: 26px;
                border-width: 3px;
            }
        }

        .cryptobridge-notification-badge {
            position: absolute;
            top: -6px;
            right: -6px;
            background: var(--cryptobridge-error);
            color: white;
            font-size: 12px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            border: 3px solid white;
            animation: cryptobridge-pulse 2s infinite;
        }

        @keyframes cryptobridge-pulse {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        /* Enhanced Mobile-Friendly Container */
        .cryptobridge-support-container {
            position: absolute;
            bottom: 90px;
            right: 0;
            width: 420px;
            max-width: calc(100vw - 32px);
            height: 700px;
            max-height: calc(100vh - 140px);
            background: var(--cryptobridge-background);
            border-radius: 24px;
            box-shadow: var(--cryptobridge-shadow-lg);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid var(--cryptobridge-border);
            transform-origin: bottom right;
        }

        @media (max-width: 768px) {
            .cryptobridge-support-container {
                width: 100%;
                height: 85vh;
                max-height: 85vh;
                bottom: 84px;
                right: 0;
                left: 0;
                margin: 0 auto;
                border-radius: 20px 20px 0 0;
            }
        }

        @media (max-width: 480px) {
            .cryptobridge-support-container {
                height: 90vh;
                max-height: 90vh;
            }
        }

        .cryptobridge-support-container.active {
            display: flex;
            animation: cryptobridge-slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes cryptobridge-slideUp {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Enhanced Mobile Header */
        .cryptobridge-support-header {
            background: var(--cryptobridge-gradient);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .cryptobridge-support-header {
                padding: 16px;
                gap: 12px;
            }
        }

        .cryptobridge-agent-avatar {
            width: 56px;
            height: 56px;
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            backdrop-filter: blur(10px);
            border: 3px solid rgba(255,255,255,0.3);
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-agent-avatar {
                width: 48px;
                height: 48px;
                font-size: 20px;
            }
        }

        .cryptobridge-agent-info h3 {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            line-height: 1.3;
        }

        .cryptobridge-agent-info p {
            font-size: 13px;
            opacity: 0.9;
            margin: 6px 0 0;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .cryptobridge-status-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .cryptobridge-status-dot {
            width: 10px;
            height: 10px;
            background: var(--cryptobridge-success-light);
            border-radius: 50%;
            position: relative;
            flex-shrink: 0;
        }

        .cryptobridge-status-dot::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--cryptobridge-success-light);
            border-radius: 50%;
            animation: cryptobridge-ping 1.5s infinite;
        }

        @keyframes cryptobridge-ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .cryptobridge-header-actions {
            margin-left: auto;
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-header-actions {
                gap: 8px;
            }
        }

        .cryptobridge-header-action {
            background: rgba(255,255,255,0.15);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 16px;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-header-action {
                width: 36px;
                height: 36px;
                border-radius: 10px;
                font-size: 14px;
            }
        }

        .cryptobridge-header-action:hover {
            background: rgba(255,255,255,0.25);
            transform: translateY(-1px);
        }

        /* Enhanced Messages Area for Mobile */
        .cryptobridge-support-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: var(--cryptobridge-surface);
            display: flex;
            flex-direction: column;
            gap: 16px;
            position: relative;
            min-height: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-support-messages {
                padding: 16px;
                gap: 12px;
            }
        }

        .cryptobridge-welcome-section {
            background: linear-gradient(135deg, rgba(37,99,235,0.08), rgba(37,99,235,0.03));
            border: 1px solid rgba(37,99,235,0.15);
            border-radius: 18px;
            padding: 20px;
            margin-bottom: 10px;
            animation: cryptobridge-slideInLeft 0.5s ease;
            backdrop-filter: blur(10px);
        }

        @media (max-width: 768px) {
            .cryptobridge-welcome-section {
                padding: 16px;
                margin-bottom: 8px;
            }
        }

        @keyframes cryptobridge-slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .cryptobridge-message {
            max-width: 85%;
            padding: 16px 18px;
            border-radius: 22px;
            font-size: 14.5px;
            line-height: 1.5;
            position: relative;
            animation: cryptobridge-messageAppear 0.3s ease;
            box-shadow: var(--cryptobridge-shadow);
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        @media (max-width: 768px) {
            .cryptobridge-message {
                max-width: 90%;
                padding: 14px 16px;
                font-size: 14px;
                line-height: 1.4;
            }
        }

        @keyframes cryptobridge-messageAppear {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .cryptobridge-message.bot {
            background: white;
            border: 1px solid var(--cryptobridge-border);
            border-bottom-left-radius: 8px;
            align-self: flex-start;
            margin-right: auto;
        }

        .cryptobridge-message.user {
            background: var(--cryptobridge-gradient);
            color: white;
            border-bottom-right-radius: 8px;
            align-self: flex-end;
            margin-left: auto;
        }

        .cryptobridge-message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 8px;
            display: block;
            font-weight: 500;
        }

        .cryptobridge-message-typing {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 16px 20px;
            background: white;
            border-radius: 22px;
            border: 1px solid var(--cryptobridge-border);
            width: fit-content;
            border-bottom-left-radius: 8px;
            margin-bottom: 5px;
            box-shadow: var(--cryptobridge-shadow);
        }

        .cryptobridge-typing-text {
            font-size: 13px;
            color: var(--cryptobridge-text-secondary);
            font-style: italic;
        }

        .cryptobridge-typing-dots {
            display: flex;
            gap: 4px;
        }

        .cryptobridge-typing-dots span {
            width: 8px;
            height: 8px;
            background: var(--cryptobridge-text-secondary);
            border-radius: 50%;
            animation: cryptobridge-typingBounce 1.4s infinite ease-in-out;
        }

        .cryptobridge-typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .cryptobridge-typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        @keyframes cryptobridge-typingBounce {
            0%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-6px); }
        }

        /* Enhanced Information Cards */
        .cryptobridge-info-card {
            background: white;
            border: 1px solid var(--cryptobridge-border);
            border-radius: 16px;
            padding: 18px;
            margin: 8px 0;
            border-left: 5px solid var(--cryptobridge-primary);
            box-shadow: var(--cryptobridge-shadow);
        }

        @media (max-width: 768px) {
            .cryptobridge-info-card {
                padding: 16px;
                margin: 6px 0;
                border-left-width: 4px;
            }
        }

        .cryptobridge-info-card.success {
            border-left-color: var(--cryptobridge-success);
            background: linear-gradient(135deg, rgba(16,185,129,0.05), rgba(16,185,129,0.02));
        }

        .cryptobridge-info-card.warning {
            border-left-color: var(--cryptobridge-warning);
            background: linear-gradient(135deg, rgba(245,158,11,0.05), rgba(245,158,11,0.02));
        }

        .cryptobridge-info-card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .cryptobridge-info-card-icon {
            width: 34px;
            height: 34px;
            background: var(--cryptobridge-primary);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            flex-shrink: 0;
        }

        .cryptobridge-info-card.success .cryptobridge-info-card-icon {
            background: var(--cryptobridge-success);
        }

        .cryptobridge-info-card.warning .cryptobridge-info-card-icon {
            background: var(--cryptobridge-warning);
        }

        .cryptobridge-info-card-title {
            font-weight: 700;
            font-size: 15px;
            color: var(--cryptobridge-text-primary);
        }

        .cryptobridge-info-card-content {
            font-size: 13.5px;
            color: var(--cryptobridge-text-secondary);
            line-height: 1.5;
        }

        /* Enhanced Input Area for Mobile */
        .cryptobridge-support-input-area {
            padding: 16px;
            background: white;
            border-top: 1px solid var(--cryptobridge-border);
            position: sticky;
            bottom: 0;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .cryptobridge-support-input-area {
                padding: 12px 16px;
            }
        }

        .cryptobridge-input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        @media (max-width: 768px) {
            .cryptobridge-input-container {
                gap: 10px;
            }
        }

        .cryptobridge-support-input {
            flex: 1;
            padding: 14px 18px;
            border: 2px solid var(--cryptobridge-border);
            border-radius: 16px;
            font-size: 14.5px;
            line-height: 1.5;
            outline: none;
            transition: all 0.3s;
            background: var(--cryptobridge-surface);
            resize: none;
            min-height: 50px;
            max-height: 100px;
            font-family: inherit;
        }

        @media (max-width: 768px) {
            .cryptobridge-support-input {
                padding: 12px 16px;
                font-size: 14px;
                min-height: 48px;
            }
        }

        .cryptobridge-support-input:focus {
            border-color: var(--cryptobridge-primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
        }

        .cryptobridge-send-button {
            width: 52px;
            height: 52px;
            background: var(--cryptobridge-gradient);
            border: none;
            border-radius: 16px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 18px;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-send-button {
                width: 48px;
                height: 48px;
                border-radius: 14px;
                font-size: 16px;
            }
        }

        .cryptobridge-send-button:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(37,99,235,0.3);
        }

        .cryptobridge-send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Enhanced Quick Actions for Mobile */
        .cryptobridge-quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 16px;
            background: white;
            border-top: 1px solid var(--cryptobridge-border);
            max-height: 120px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .cryptobridge-quick-actions {
                padding: 12px 16px;
                gap: 8px;
                max-height: 110px;
            }
        }

        .cryptobridge-quick-action {
            padding: 10px 16px;
            background: var(--cryptobridge-surface);
            border: 1px solid var(--cryptobridge-border);
            border-radius: 14px;
            font-size: 13px;
            color: var(--cryptobridge-text-primary);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .cryptobridge-quick-action {
                padding: 8px 14px;
                font-size: 12.5px;
                gap: 6px;
            }
        }

        .cryptobridge-quick-action:hover {
            background: white;
            border-color: var(--cryptobridge-primary);
            color: var(--cryptobridge-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(37,99,235,0.1);
        }

        .cryptobridge-quick-action i {
            font-size: 12px;
        }

        /* Enhanced Ticket System */
        .cryptobridge-ticket-system {
            padding: 20px;
            background: white;
            display: none;
            flex-direction: column;
            gap: 16px;
            animation: cryptobridge-fadeIn 0.3s ease;
            overflow-y: auto;
            flex: 1;
        }

        @media (max-width: 768px) {
            .cryptobridge-ticket-system {
                padding: 16px;
                gap: 14px;
            }
        }

        .cryptobridge-ticket-system.active {
            display: flex;
        }

        .cryptobridge-form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .cryptobridge-form-label {
            font-size: 13.5px;
            font-weight: 600;
            color: var(--cryptobridge-text-primary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .cryptobridge-form-label i {
            color: var(--cryptobridge-primary);
            font-size: 12px;
        }

        .cryptobridge-form-input {
            padding: 14px 16px;
            border: 2px solid var(--cryptobridge-border);
            border-radius: 12px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
            background: var(--cryptobridge-surface);
        }

        .cryptobridge-form-input:focus {
            border-color: var(--cryptobridge-primary);
            background: white;
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1);
        }

        .cryptobridge-form-actions {
            display: flex;
            gap: 12px;
            margin-top: 10px;
        }

        .cryptobridge-form-button {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-size: 14.5px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .cryptobridge-form-button.primary {
            background: linear-gradient(135deg, var(--cryptobridge-success), var(--cryptobridge-success-light));
            color: white;
        }

        .cryptobridge-form-button.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16,185,129,0.3);
        }

        .cryptobridge-form-button.secondary {
            background: var(--cryptobridge-surface);
            color: var(--cryptobridge-text-secondary);
            border: 1px solid var(--cryptobridge-border);
        }

        .cryptobridge-form-button.secondary:hover {
            background: white;
            border-color: var(--cryptobridge-border);
            color: var(--cryptobridge-text-primary);
        }

        /* Enhanced Success State */
        .cryptobridge-success-state {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 30px 20px;
            text-align: center;
            background: white;
            flex: 1;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .cryptobridge-success-state {
                padding: 24px 16px;
            }
        }

        .cryptobridge-success-state.active {
            display: flex;
            animation: cryptobridge-fadeInUp 0.5s ease;
        }

        @keyframes cryptobridge-fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .cryptobridge-success-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--cryptobridge-success), var(--cryptobridge-success-light));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            color: white;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(16,185,129,0.3);
        }

        @media (max-width: 768px) {
            .cryptobridge-success-icon {
                width: 70px;
                height: 70px;
                font-size: 32px;
                margin-bottom: 16px;
            }
        }

        .cryptobridge-success-content h3 {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--cryptobridge-text-primary);
        }

        @media (max-width: 768px) {
            .cryptobridge-success-content h3 {
                font-size: 18px;
                margin-bottom: 10px;
            }
        }

        .cryptobridge-success-content p {
            font-size: 14.5px;
            color: var(--cryptobridge-text-secondary);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .cryptobridge-ticket-id {
            background: var(--cryptobridge-surface);
            border: 1px solid var(--cryptobridge-border);
            border-radius: 12px;
            padding: 12px 20px;
            font-family: 'SF Mono', 'Roboto Mono', monospace;
            font-size: 13px;
            color: var(--cryptobridge-text-primary);
            margin: 10px 0;
            font-weight: 600;
            width: 100%;
            max-width: 300px;
            word-break: break-all;
        }

        /* Typing Indicator */
        .cryptobridge-typing-with-agent {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .cryptobridge-typing-agent-avatar {
            width: 36px;
            height: 36px;
            background: var(--cryptobridge-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 14px;
            flex-shrink: 0;
        }

        /* Enhanced Mobile Responsive Design */
        @media (max-width: 380px) {
            .cryptobridge-support-container {
                height: 92vh;
                max-height: 92vh;
            }
            
            .cryptobridge-quick-actions {
                flex-direction: column;
                max-height: 140px;
            }
            
            .cryptobridge-quick-action {
                width: 100%;
                justify-content: center;
            }
        }

        /* Enhanced Dark Mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --cryptobridge-background: #1e293b;
                --cryptobridge-surface: #0f172a;
                --cryptobridge-border: #334155;
                --cryptobridge-text-primary: #f1f5f9;
                --cryptobridge-text-secondary: #cbd5e1;
            }

            .cryptobridge-support-container {
                background: var(--cryptobridge-background);
                border-color: var(--cryptobridge-border);
            }

            .cryptobridge-support-messages {
                background: var(--cryptobridge-surface);
            }

            .cryptobridge-message.bot {
                background: #334155;
                border-color: #475569;
            }

            .cryptobridge-message-typing {
                background: #334155;
                border-color: #475569;
            }

            .cryptobridge-info-card {
                background: #334155;
                border-color: #475569;
            }

            .cryptobridge-support-input-area,
            .cryptobridge-quick-actions,
            .cryptobridge-ticket-system,
            .cryptobridge-success-state {
                background: var(--cryptobridge-background);
                border-color: var(--cryptobridge-border);
            }

            .cryptobridge-support-input,
            .cryptobridge-form-input {
                background: var(--cryptobridge-surface);
                border-color: var(--cryptobridge-border);
                color: var(--cryptobridge-text-primary);
            }

            .cryptobridge-quick-action {
                background: #334155;
                border-color: #475569;
                color: var(--cryptobridge-text-primary);
            }

            .cryptobridge-quick-action:hover {
                background: #475569;
                border-color: var(--cryptobridge-primary);
            }

            .cryptobridge-ticket-id {
                background: #334155;
                border-color: #475569;
                color: var(--cryptobridge-text-primary);
            }
        }

        /* Scrollbar Styling */
        .cryptobridge-support-messages::-webkit-scrollbar,
        .cryptobridge-quick-actions::-webkit-scrollbar {
            width: 6px;
        }

        .cryptobridge-support-messages::-webkit-scrollbar-track {
            background: transparent;
        }

        .cryptobridge-support-messages::-webkit-scrollbar-thumb {
            background: var(--cryptobridge-border);
            border-radius: 3px;
        }

        .cryptobridge-support-messages::-webkit-scrollbar-thumb:hover {
            background: var(--cryptobridge-text-secondary);
        }
    </style>
</head>
<body>
    <div class="cryptobridge-support-system">
        <!-- Enhanced Floating Support Button -->
        <div class="cryptobridge-floating-support">
            <div class="cryptobridge-support-toggle" id="cryptobridgeSupportToggle">
                <i class="fas fa-headset"></i>
                <div class="cryptobridge-notification-badge" id="cryptobridgeNotificationBadge" style="display: none;">1</div>
            </div>

            <!-- Enhanced Support Container -->
            <div class="cryptobridge-support-container" id="cryptobridgeSupportContainer">
                <!-- Enhanced Header -->
                <div class="cryptobridge-support-header">
                    <div class="cryptobridge-agent-avatar" id="cryptobridgeAgentAvatar">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div class="cryptobridge-agent-info">
                        <h3 id="cryptobridgeAgentName">Sarah Johnson</h3>
                        <p>
                            <span class="cryptobridge-status-indicator">
                                <span class="cryptobridge-status-dot"></span>
                                <span>Live Support â€¢ Online Now</span>
                            </span>
                        </p>
                    </div>
                    <div class="cryptobridge-header-actions">
                        <button class="cryptobridge-header-action" id="cryptobridgeMinimizeChat" title="Minimize">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button class="cryptobridge-header-action" id="cryptobridgeCloseChat" title="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>

                <!-- Enhanced Messages Area -->
                <div class="cryptobridge-support-messages" id="cryptobridgeSupportMessages">
                    <!-- Messages load here -->
                </div>

                <!-- Enhanced Quick Actions -->
                <div class="cryptobridge-quick-actions" id="cryptobridgeQuickActions">
                    <button class="cryptobridge-quick-action" data-action="transaction-help">
                        <i class="fas fa-exchange-alt"></i> Transaction Help
                    </button>
                    <button class="cryptobridge-quick-action" data-action="payment-time">
                        <i class="fas fa-clock"></i> Processing Time
                    </button>
                    <button class="cryptobridge-quick-action" data-action="security-check">
                        <i class="fas fa-shield-alt"></i> Security Check
                    </button>
                    <button class="cryptobridge-quick-action" data-action="submit-ticket">
                        <i class="fas fa-ticket-alt"></i> Submit Ticket
                    </button>
                </div>

                <!-- Enhanced Input Area -->
                <div class="cryptobridge-support-input-area" id="cryptobridgeSupportInputArea">
                    <div class="cryptobridge-input-container">
                        <textarea class="cryptobridge-support-input" id="cryptobridgeSupportInput" 
                                  placeholder="Type your message here... We're here to help 24/7 ðŸš€" 
                                  rows="1"></textarea>
                        <button class="cryptobridge-send-button" id="cryptobridgeSendButton">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>

                <!-- Enhanced Ticket System -->
                <div class="cryptobridge-ticket-system" id="cryptobridgeTicketSystem">
                    <div class="cryptobridge-form-group">
                        <label class="cryptobridge-form-label">
                            <i class="fas fa-envelope"></i> Your PayPal Email
                        </label>
                        <input type="email" class="cryptobridge-form-input" id="cryptobridgeTicketEmail" 
                               placeholder="your.email@example.com" required>
                    </div>
                    <div class="cryptobridge-form-group">
                        <label class="cryptobridge-form-label">
                            <i class="fas fa-wallet"></i> Wallet Address Used
                        </label>
                        <input type="text" class="cryptobridge-form-input" id="cryptobridgeTicketWallet" 
                               placeholder="0x... or bc1..." required>
                    </div>
                    <div class="cryptobridge-form-group">
                        <label class="cryptobridge-form-label">
                            <i class="fas fa-comment-dots"></i> What happened?
                        </label>
                        <textarea class="cryptobridge-form-input" id="cryptobridgeTicketMessage" 
                                  placeholder="Please describe the issue in detail. The more information you provide, the better we can help! ðŸ˜Š"
                                  rows="3"></textarea>
                    </div>
                    <div class="cryptobridge-form-actions">
                        <button class="cryptobridge-form-button secondary" id="cryptobridgeCancelTicket">
                            <i class="fas fa-arrow-left"></i> Back to Chat
                        </button>
                        <button class="cryptobridge-form-button primary" id="cryptobridgeSubmitTicket">
                            <i class="fas fa-paper-plane"></i> Submit Ticket
                        </button>
                    </div>
                </div>

                <!-- Enhanced Success State -->
                <div class="cryptobridge-success-state" id="cryptobridgeSuccessState">
                    <div class="cryptobridge-success-icon">
                        <i class="fas fa-check"></i>
                    </div>
                    <div class="cryptobridge-success-content">
                        <h3>Ticket Submitted Successfully! ðŸŽ‰</h3>
                        <p>Your support ticket has been received and is being processed by our team.</p>
                        <div class="cryptobridge-ticket-id" id="cryptobridgeTicketIdDisplay">TICKET-XXXXXXXX</div>
                        <p><strong>What happens next:</strong><br>
                        1. Immediate review by our specialists<br>
                        2. Blockchain verification check<br>
                        3. Personal email update within 15 minutes<br>
                        4. Resolution typically within 1-2 hours</p>
                        <button class="cryptobridge-form-button secondary" id="cryptobridgeBackToChat">
                            <i class="fas fa-comments"></i> Back to Chat
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Enhanced DOM elements with unique names
            const cryptobridgeSupportToggle = document.getElementById('cryptobridgeSupportToggle');
            const cryptobridgeSupportContainer = document.getElementById('cryptobridgeSupportContainer');
            const cryptobridgeMinimizeChat = document.getElementById('cryptobridgeMinimizeChat');
            const cryptobridgeCloseChat = document.getElementById('cryptobridgeCloseChat');
            const cryptobridgeSupportInput = document.getElementById('cryptobridgeSupportInput');
            const cryptobridgeSendButton = document.getElementById('cryptobridgeSendButton');
            const cryptobridgeSupportMessages = document.getElementById('cryptobridgeSupportMessages');
            const cryptobridgeQuickActions = document.getElementById('cryptobridgeQuickActions');
            const cryptobridgeTicketSystem = document.getElementById('cryptobridgeTicketSystem');
            const cryptobridgeSuccessState = document.getElementById('cryptobridgeSuccessState');
            const cryptobridgeNotificationBadge = document.getElementById('cryptobridgeNotificationBadge');
            
            // Enhanced state management
            let cryptobridgeIsOpen = false;
            let cryptobridgeIsTyping = false;
            let cryptobridgeConversationHistory = [];
            let cryptobridgeHasShownWelcome = false;
            
            // AI Integration Configuration
            const CRYPTOBRIDGE_AI_CONFIG = {
                apiKey: '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', // Replace with your API key
                endpoint: 'https://api.openai.com/v1/chat/completions',
                model: 'gpt-4',
                temperature: 0.7,
                maxTokens: 500
            };
            
            // Professional AI Responses Knowledge Base
            const CRYPTOBRIDGE_KNOWLEDGE_BASE = {
                companyInfo: "CryptoBridge is a licensed cryptocurrency exchange platform offering secure crypto-to-PayPal transactions with a +10% bonus program.",
                processingTimes: {
                    standard: "15-30 minutes",
                    priority: "5-15 minutes",
                    blockchainConfirmations: "3 confirmations required (approx. 30 minutes)"
                },
                securityFeatures: [
                    "Bank-grade SSL encryption",
                    "Multi-signature wallet technology",
                    "95% cold storage for assets",
                    "Two-factor authentication (2FA)",
                    "Regular security audits",
                    "FDIC insured for USD balances"
                ],
                bonusProgram: "The +10% bonus program adds 10% extra to the market rate. Send $100 crypto, receive $110 in PayPal. Minimum: $50, Maximum: $10,000 daily.",
                supportedCryptos: ["Bitcoin (BTC)", "Ethereum (ETH)", "Litecoin (LTC)", "Bitcoin Cash (BCH)", "USDT", "USDC"],
                fees: "Transaction fee: 1% (minimum $2). No hidden fees. Bonus covers network fees."
            };
            
            // Initialize enhanced support system
            function cryptobridgeInitSupportSystem() {
                console.log('CryptoBridge Professional Support System Initialized');
                cryptobridgeSetupEventListeners();
            }
            
            // Enhanced event listeners setup
            function cryptobridgeSetupEventListeners() {
                // Toggle support window
                cryptobridgeSupportToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    cryptobridgeToggleSupport();
                });
                
                // Minimize chat
                cryptobridgeMinimizeChat.addEventListener('click', function(e) {
                    e.stopPropagation();
                    cryptobridgeMinimizeSupport();
                });
                
                // Close chat
                cryptobridgeCloseChat.addEventListener('click', function(e) {
                    e.stopPropagation();
                    cryptobridgeCloseSupport();
                });
                
                // Send message
                cryptobridgeSendButton.addEventListener('click', cryptobridgeSendMessage);
                
                // Enhanced enter key handling
                cryptobridgeSupportInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        if (!cryptobridgeIsTyping) {
                            cryptobridgeSendMessage();
                        }
                    }
                });
                
                // Enhanced auto-resize textarea with mobile optimization
                cryptobridgeSupportInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    const maxHeight = window.innerWidth < 768 ? 80 : 120;
                    this.style.height = Math.min(this.scrollHeight, maxHeight) + 'px';
                });
                
                // Quick actions with touch optimization
                cryptobridgeQuickActions.addEventListener('click', function(e) {
                    const quickAction = e.target.closest('.cryptobridge-quick-action');
                    if (quickAction) {
                        const action = quickAction.dataset.action;
                        cryptobridgeHandleQuickAction(action);
                    }
                });
                
                // Enhanced touch events for mobile
                cryptobridgeQuickActions.addEventListener('touchstart', function(e) {
                    const quickAction = e.target.closest('.cryptobridge-quick-action');
                    if (quickAction) {
                        quickAction.style.transform = 'translateY(-1px)';
                    }
                }, { passive: true });
                
                cryptobridgeQuickActions.addEventListener('touchend', function(e) {
                    const quickAction = e.target.closest('.cryptobridge-quick-action');
                    if (quickAction) {
                        quickAction.style.transform = '';
                    }
                }, { passive: true });
                
                // Ticket system buttons
                document.getElementById('cryptobridgeCancelTicket').addEventListener('click', cryptobridgeHideTicketSystem);
                document.getElementById('cryptobridgeSubmitTicket').addEventListener('click', cryptobridgeSubmitTicket);
                document.getElementById('cryptobridgeBackToChat').addEventListener('click', cryptobridgeBackToChat);
                
                // Enhanced mobile-friendly outside click handling
                document.addEventListener('click', function(e) {
                    if (cryptobridgeIsOpen && 
                        !cryptobridgeSupportContainer.contains(e.target) && 
                        !cryptobridgeSupportToggle.contains(e.target)) {
                        cryptobridgeMinimizeSupport();
                    }
                });
                
                // Touch optimization for mobile
                document.addEventListener('touchstart', function(e) {
                    if (cryptobridgeIsOpen && 
                        !cryptobridgeSupportContainer.contains(e.target) && 
                        !cryptobridgeSupportToggle.contains(e.target)) {
                        cryptobridgeMinimizeSupport();
                    }
                }, { passive: true });
                
                // Prevent clicks inside support container from closing it
                cryptobridgeSupportContainer.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
                
                // Handle mobile keyboard appearance
                window.addEventListener('resize', cryptobridgeHandleMobileKeyboard);
                
                // Load previous conversation if exists
                cryptobridgeLoadConversation();
            }
            
            // Handle mobile keyboard
            function cryptobridgeHandleMobileKeyboard() {
                if (window.innerWidth < 768 && cryptobridgeIsOpen) {
                    setTimeout(() => {
                        cryptobridgeSupportMessages.scrollTop = cryptobridgeSupportMessages.scrollHeight;
                    }, 300);
                }
            }
            
            // Toggle support window with enhanced UX
            function cryptobridgeToggleSupport() {
                cryptobridgeIsOpen = !cryptobridgeIsOpen;
                cryptobridgeSupportToggle.classList.toggle('active');
                cryptobridgeSupportContainer.classList.toggle('active');
                
                if (cryptobridgeIsOpen) {
                    console.log('Opening CryptoBridge support chat');
                    cryptobridgeSupportInput.focus();
                    cryptobridgeUpdateNotificationBadge(0);
                    
                    // Show welcome message only once per session
                    if (!cryptobridgeHasShownWelcome) {
                        cryptobridgeShowWelcomeMessage();
                        cryptobridgeHasShownWelcome = true;
                    }
                    
                    // Save conversation state
                    cryptobridgeSaveConversation();
                } else {
                    console.log('Closing CryptoBridge support chat');
                }
                
                // Handle mobile viewport
                if (window.innerWidth < 768) {
                    document.body.style.overflow = cryptobridgeIsOpen ? 'hidden' : '';
                }
            }
            
            // Minimize support with smooth animation
            function cryptobridgeMinimizeSupport() {
                cryptobridgeIsOpen = false;
                cryptobridgeSupportContainer.classList.remove('active');
                cryptobridgeSupportToggle.classList.remove('active');
                
                if (window.innerWidth < 768) {
                    document.body.style.overflow = '';
                }
                
                console.log('CryptoBridge chat minimized');
            }
            
            // Close support
            function cryptobridgeCloseSupport() {
                cryptobridgeMinimizeSupport();
                cryptobridgeSaveConversation();
                console.log('CryptoBridge chat closed');
            }
            
            // Enhanced send message with AI integration
            async function cryptobridgeSendMessage() {
                const message = cryptobridgeSupportInput.value.trim();
                if (!message || cryptobridgeIsTyping) return;
                
                // Add user message
                cryptobridgeAddMessage('user', message);
                cryptobridgeSupportInput.value = '';
                cryptobridgeSupportInput.style.height = 'auto';
                cryptobridgeSendButton.disabled = true;
                
                // Show typing indicator
                cryptobridgeShowTypingIndicator();
                
                try {
                    // Generate AI response
                    const aiResponse = await cryptobridgeGenerateAIResponse(message);
                    cryptobridgeHideTypingIndicator();
                    cryptobridgeAddMessage('bot', aiResponse);
                } catch (error) {
                    console.error('AI Error:', error);
                    cryptobridgeHideTypingIndicator();
                    // Fallback to rule-based response
                    const fallbackResponse = cryptobridgeGenerateFallbackResponse(message);
                    cryptobridgeAddMessage('bot', fallbackResponse);
                }
                
                cryptobridgeSendButton.disabled = false;
                cryptobridgeSupportInput.focus();
                cryptobridgeSaveConversation();
            }
            
            // Enhanced AI response generation
            async function cryptobridgeGenerateAIResponse(userMessage) {
                // For demo, use rule-based. Replace with actual API call:
                // return await cryptobridgeCallOpenAI(userMessage);
                
                // Professional rule-based responses for demo
                const lowerMessage = userMessage.toLowerCase();
                
                if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                    return `ðŸ‘‹ Hello! I'm Sarah Johnson, your dedicated CryptoBridge support specialist. I'm here to assist you with all your cryptocurrency exchange needs. How may I help you today?`;
                }
                
                if (lowerMessage.includes('bonus') || lowerMessage.includes('+10%')) {
                    return `ðŸŽ¯ **CryptoBridge +10% Bonus Program**\n\nOur exclusive bonus program adds 10% extra value to your transactions. For example, if you exchange $100 worth of cryptocurrency, you'll receive $110 in your PayPal account.\n\n**Key Details:**\nâ€¢ Minimum transaction: $50\nâ€¢ Maximum daily: $10,000\nâ€¢ Bonus applies to all supported cryptocurrencies\nâ€¢ No additional fees - bonus covers network costs\n\nWould you like to proceed with a bonus transaction today?`;
                }
                
                if (lowerMessage.includes('time') || lowerMessage.includes('how long') || lowerMessage.includes('processing')) {
                    return `â±ï¸ **Transaction Processing Times**\n\nAt CryptoBridge, we pride ourselves on efficient processing:\n\nâ€¢ **Standard Transactions:** ${CRYPTOBRIDGE_KNOWLEDGE_BASE.processingTimes.standard}\nâ€¢ **Priority Processing:** ${CRYPTOBRIDGE_KNOWLEDGE_BASE.processingTimes.priority}\nâ€¢ **Blockchain Confirmations:** ${CRYPTOBRIDGE_KNOWLEDGE_BASE.processingTimes.blockchainConfirmations}\n\nMost transactions are completed within 15-30 minutes. Delays may occur during network congestion.`;
                }
                
                if (lowerMessage.includes('security') || lowerMessage.includes('safe') || lowerMessage.includes('trust')) {
                    return `ðŸ”’ **CryptoBridge Security Assurance**\n\nYour security is our top priority. We implement multiple layers of protection:\n\n${CRYPTOBRIDGE_KNOWLEDGE_BASE.securityFeatures.map(feature => `â€¢ ${feature}`).join('\n')}\n\nWe are fully licensed and regulated, with $250 million in insurance coverage for digital assets.`;
                }
                
                if (lowerMessage.includes('fee') || lowerMessage.includes('cost')) {
                    return `ðŸ’° **Transparent Fee Structure**\n\nCryptoBridge maintains complete fee transparency:\n\nâ€¢ **Transaction Fee:** ${CRYPTOBRIDGE_KNOWLEDGE_BASE.fees}\nâ€¢ **Network Fees:** Covered by our bonus program\nâ€¢ **No Hidden Charges:** Guaranteed\nâ€¢ **PayPal Withdrawal:** Free\n\nThe +10% bonus typically offsets all fees, providing you with better rates than the market average.`;
                }
                
                if (lowerMessage.includes('status') || lowerMessage.includes('track') || lowerMessage.includes('where')) {
                    return `ðŸ“Š **Transaction Status Check**\n\nTo track your transaction:\n\n1. Check your registered email for confirmation\n2. Use the transaction ID provided in your receipt\n3. Visit our transaction portal at portal.cryptobridge.com\n4. Contact me with your transaction ID for real-time updates\n\nPlease provide your transaction ID, and I'll check the current status immediately.`;
                }
                
                if (lowerMessage.includes('thank') || lowerMessage.includes('thanks')) {
                    return `You're very welcome! ðŸ˜Š It's my pleasure to assist you. Is there anything else about CryptoBridge services you'd like to know? Remember, we're available 24/7 for your convenience.`;
                }
                
                if (lowerMessage.includes('problem') || lowerMessage.includes('issue') || lowerMessage.includes('help')) {
                    return `I understand you're experiencing an issue. Let me help you resolve this efficiently.\n\nPlease provide:\n1. Your transaction ID (if applicable)\n2. The cryptocurrency involved\n3. Amount in USD\n4. Time of transaction\n\nAlternatively, you can click "Submit Ticket" below for dedicated technical support.`;
                }
                
                if (lowerMessage.includes('crypto') || lowerMessage.includes('coin') || lowerMessage.includes('currency')) {
                    return `ðŸª™ **Supported Cryptocurrencies**\n\nCryptoBridge supports a wide range of cryptocurrencies:\n\n${CRYPTOBRIDGE_KNOWLEDGE_BASE.supportedCryptos.map(crypto => `â€¢ ${crypto}`).join('\n')}\n\nWe're constantly adding new cryptocurrencies based on user demand and security assessment.`;
                }
                
                // Default professional response
                return `Thank you for your message regarding "${userMessage}". I'm here to provide you with accurate information about CryptoBridge services.\n\nTo better assist you, could you please specify:\n1. Are you referring to a specific transaction?\n2. Which cryptocurrency are you interested in?\n3. Do you have a particular concern about our services?\n\nI'm ready to help you with any aspect of our platform! ðŸ’¼`;
            }
            
            // Actual OpenAI API call (commented out for demo)
            async function cryptobridgeCallOpenAI(userMessage) {
                const response = await fetch(CRYPTOBRIDGE_AI_CONFIG.endpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${CRYPTOBRIDGE_AI_CONFIG.apiKey}`
                    },
                    body: JSON.stringify({
                        model: CRYPTOBRIDGE_AI_CONFIG.model,
                        messages: [
                            {
                                role: "system",
                                content: `You are Sarah Johnson, a professional support specialist for CryptoBridge cryptocurrency exchange. Provide accurate, helpful information about:
                                ${JSON.stringify(CRYPTOBRIDGE_KNOWLEDGE_BASE)}
                                
                                Always be:
                                - Professional and courteous
                                - Clear and concise
                                - Factual and accurate
                                - Helpful and solution-oriented
                                - Use bullet points for clarity
                                - Add relevant emojis for engagement
                                
                                Format responses with markdown for readability.`
                            },
                            {
                                role: "user",
                                content: userMessage
                            }
                        ],
                        temperature: CRYPTOBRIDGE_AI_CONFIG.temperature,
                        max_tokens: CRYPTOBRIDGE_AI_CONFIG.maxTokens
                    })
                });
                
                const data = await response.json();
                return data.choices[0].message.content;
            }
            
            // Fallback response generator
            function cryptobridgeGenerateFallbackResponse(userMessage) {
                return `Thank you for your inquiry. I'm currently experiencing high demand. Please try rephrasing your question or use one of the quick action buttons below for immediate assistance regarding:\n\nâ€¢ Transaction processing times â±ï¸\nâ€¢ Security features ðŸ”’\nâ€¢ Bonus program details ðŸŽ¯\nâ€¢ Technical support ðŸ› ï¸`;
            }
            
            // Enhanced add message with better formatting
            function cryptobridgeAddMessage(sender, content) {
                const messageDiv = document.createElement('div');
                const timestamp = new Date();
                const timeString = timestamp.toLocaleTimeString([], { 
                    hour: '2-digit', 
                    minute: '2-digit',
                    hour12: true 
                }).toLowerCase();
                
                messageDiv.className = `cryptobridge-message ${sender}`;
                
                // Format content with line breaks
                const formattedContent = content.replace(/\n/g, '<br>');
                
                if (sender === 'bot') {
                    messageDiv.innerHTML = `
                        <div style="white-space: pre-line;">${formattedContent}</div>
                        <span class="cryptobridge-message-time">${timeString} â€¢ Sarah Johnson</span>
                    `;
                } else {
                    messageDiv.innerHTML = `
                        <div style="white-space: pre-line;">${formattedContent}</div>
                        <span class="cryptobridge-message-time">${timeString}</span>
                    `;
                }
                
                cryptobridgeSupportMessages.appendChild(messageDiv);
                
                // Smooth scroll to bottom
                setTimeout(() => {
                    cryptobridgeSupportMessages.scrollTo({
                        top: cryptobridgeSupportMessages.scrollHeight,
                        behavior: 'smooth'
                    });
                }, 100);
                
                // Add to conversation history
                cryptobridgeConversationHistory.push({
                    sender,
                    content,
                    timestamp: timestamp.toISOString()
                });
            }
            
            // Enhanced typing indicator
            function cryptobridgeShowTypingIndicator() {
                if (cryptobridgeIsTyping) return;
                cryptobridgeIsTyping = true;
                
                const typingDiv = document.createElement('div');
                typingDiv.className = 'cryptobridge-typing-with-agent';
                typingDiv.innerHTML = `
                    <div class="cryptobridge-typing-agent-avatar">
                        ðŸ‘©â€ðŸ’¼
                    </div>
                    <div class="cryptobridge-message-typing">
                        <span class="cryptobridge-typing-text">Sarah Johnson is typing</span>
                        <div class="cryptobridge-typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                `;
                
                cryptobridgeSupportMessages.appendChild(typingDiv);
                cryptobridgeSupportMessages.scrollTop = cryptobridgeSupportMessages.scrollHeight;
            }
            
            // Hide typing indicator
            function cryptobridgeHideTypingIndicator() {
                cryptobridgeIsTyping = false;
                const typingIndicator = cryptobridgeSupportMessages.querySelector('.cryptobridge-typing-with-agent');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // Enhanced welcome message (shown once per session)
            function cryptobridgeShowWelcomeMessage() {
                const welcomeDiv = document.createElement('div');
                welcomeDiv.className = 'cryptobridge-welcome-section';
                welcomeDiv.innerHTML = `
                    <h3 style="margin-top: 0; color: var(--cryptobridge-primary); display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-shield-alt"></i> Welcome to CryptoBridge Professional Support
                    </h3>
                    <p style="margin-bottom: 12px; color: var(--cryptobridge-text-primary); font-weight: 500;">
                        Hello! I'm <strong>Sarah Johnson</strong>, your dedicated support specialist. I'm here to provide you with expert assistance for all your cryptocurrency exchange needs.
                    </p>
                    <div style="background: rgba(37,99,235,0.05); border-radius: 12px; padding: 12px; margin: 12px 0;">
                        <p style="margin: 0 0 8px 0; font-weight: 600; color: var(--cryptobridge-primary);">
                            <i class="fas fa-bolt"></i> How I can assist you:
                        </p>
                        <ul style="margin: 0; padding-left: 20px; color: var(--cryptobridge-text-secondary);">
                            <li>Transaction processing and tracking</li>
                            <li>+10% bonus program inquiries</li>
                            <li>Security and account protection</li>
                            <li>Technical support and troubleshooting</li>
                            <li>Market information and rates</li>
                        </ul>
                    </div>
                    <p style="margin-top: 12px; margin-bottom: 0; color: var(--cryptobridge-text-secondary); font-size: 13.5px;">
                        <i class="fas fa-clock"></i> Available 24/7 | <i class="fas fa-check-circle"></i> Licensed & Regulated
                    </p>
                `;
                
                cryptobridgeSupportMessages.appendChild(welcomeDiv);
                cryptobridgeSupportMessages.scrollTop = cryptobridgeSupportMessages.scrollHeight;
            }
            
            // Handle quick actions with enhanced responses
            function cryptobridgeHandleQuickAction(action) {
                console.log('Quick action triggered:', action);
                
                let userMessage = '';
                switch(action) {
                    case 'transaction-help':
                        userMessage = "I need assistance with a cryptocurrency transaction";
                        break;
                    case 'payment-time':
                        userMessage = "What are your current processing times?";
                        break;
                    case 'security-check':
                        userMessage = "Can you detail your security measures?";
                        break;
                    case 'submit-ticket':
                        cryptobridgeShowTicketSystem();
                        return;
                }
                
                // Add user message
                cryptobridgeAddMessage('user', userMessage);
                
                // Show typing indicator
                cryptobridgeShowTypingIndicator();
                
                // Generate and show response
                setTimeout(() => {
                    cryptobridgeHideTypingIndicator();
                    const response = cryptobridgeGenerateFallbackResponse(userMessage);
                    cryptobridgeAddMessage('bot', response);
                }, 800);
            }
            
            // Show ticket system with enhanced UX
            function cryptobridgeShowTicketSystem() {
                cryptobridgeQuickActions.style.display = 'none';
                cryptobridgeSupportInputArea.style.display = 'none';
                cryptobridgeTicketSystem.classList.add('active');
                
                // Focus on first input
                setTimeout(() => {
                    document.getElementById('cryptobridgeTicketEmail').focus();
                }, 100);
            }
            
            // Hide ticket system
            function cryptobridgeHideTicketSystem() {
                cryptobridgeTicketSystem.classList.remove('active');
                cryptobridgeQuickActions.style.display = 'flex';
                cryptobridgeSupportInputArea.style.display = 'block';
                cryptobridgeSupportInput.focus();
            }
            
            // Enhanced ticket submission
            function cryptobridgeSubmitTicket() {
                const email = document.getElementById('cryptobridgeTicketEmail').value.trim();
                const wallet = document.getElementById('cryptobridgeTicketWallet').value.trim();
                const message = document.getElementById('cryptobridgeTicketMessage').value.trim();
                
                if (!email || !wallet || !message) {
                    cryptobridgeShowNotification('Please fill in all required fields', 'warning');
                    return;
                }
                
                if (!cryptobridgeValidateEmail(email)) {
                    cryptobridgeShowNotification('Please enter a valid email address', 'warning');
                    return;
                }
                
                // Generate unique ticket ID
                const ticketId = 'CB-' + Date.now() + '-' + Math.random().toString(36).substr(2, 6).toUpperCase();
                document.getElementById('cryptobridgeTicketIdDisplay').textContent = ticketId;
                
                // Show success state
                cryptobridgeTicketSystem.classList.remove('active');
                cryptobridgeSuccessState.classList.add('active');
                
                // Simulate ticket submission
                console.log('Ticket submitted:', { email, wallet, message, ticketId });
                
                // Add notification to chat
                setTimeout(() => {
                    cryptobridgeAddMessage('bot', `ðŸŽ« **Ticket Created Successfully**\n\nYour support ticket **${ticketId}** has been created. Our technical team will review your case and contact you at ${email} within 15 minutes.\n\nYou can also continue chatting with me for immediate assistance.`);
                }, 1000);
            }
            
            // Back to chat from success state
            function cryptobridgeBackToChat() {
                cryptobridgeSuccessState.classList.remove('active');
                cryptobridgeQuickActions.style.display = 'flex';
                cryptobridgeSupportInputArea.style.display = 'block';
                
                // Clear form
                document.getElementById('cryptobridgeTicketEmail').value = '';
                document.getElementById('cryptobridgeTicketWallet').value = '';
                document.getElementById('cryptobridgeTicketMessage').value = '';
                
                cryptobridgeSupportInput.focus();
            }
            
            // Enhanced notification badge
            function cryptobridgeUpdateNotificationBadge(count) {
                if (count > 0) {
                    cryptobridgeNotificationBadge.textContent = count;
                    cryptobridgeNotificationBadge.style.display = 'flex';
                    
                    // Add vibration on mobile (if supported)
                    if (navigator.vibrate && window.innerWidth < 768) {
                        navigator.vibrate(200);
                    }
                } else {
                    cryptobridgeNotificationBadge.style.display = 'none';
                }
            }
            
            // Email validation
            function cryptobridgeValidateEmail(email) {
                const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return re.test(email);
            }
            
            // Show notification
            function cryptobridgeShowNotification(message, type = 'info') {
                // Implement a toast notification system here
                console.log(`${type.toUpperCase()}: ${message}`);
            }
            
            // Save conversation to localStorage
            function cryptobridgeSaveConversation() {
                try {
                    const data = {
                        history: cryptobridgeConversationHistory,
                        timestamp: new Date().toISOString(),
                        hasShownWelcome: cryptobridgeHasShownWelcome
                    };
                    localStorage.setItem('cryptobridge_conversation', JSON.stringify(data));
                } catch (e) {
                    console.warn('Could not save conversation:', e);
                }
            }
            
            // Load conversation from localStorage
            function cryptobridgeLoadConversation() {
                try {
                    const saved = localStorage.getItem('cryptobridge_conversation');
                    if (saved) {
                        const data = JSON.parse(saved);
                        cryptobridgeConversationHistory = data.history || [];
                        cryptobridgeHasShownWelcome = data.hasShownWelcome || false;
                        
                        // Clear messages container
                        cryptobridgeSupportMessages.innerHTML = '';
                        
                        // Replay conversation history
                        if (cryptobridgeConversationHistory.length > 0) {
                            // Only show welcome if it was shown before
                            if (cryptobridgeHasShownWelcome) {
                                cryptobridgeShowWelcomeMessage();
                            }
                            
                            // Add all messages
                            cryptobridgeConversationHistory.forEach(msg => {
                                cryptobridgeAddMessage(msg.sender, msg.content);
                            });
                        }
                    }
                } catch (e) {
                    console.warn('Could not load conversation:', e);
                }
            }
            
            // Start the enhanced system
            cryptobridgeInitSupportSystem();
            
            // Demo notification after delay
            setTimeout(() => {
                if (!cryptobridgeIsOpen) {
                    cryptobridgeUpdateNotificationBadge(1);
                }
            }, 15000);
            
            // Handle mobile back button
            window.addEventListener('popstate', function() {
                if (cryptobridgeIsOpen && window.innerWidth < 768) {
                    cryptobridgeMinimizeSupport();
                }
            });
        });
    </script>
</body>
</html>
